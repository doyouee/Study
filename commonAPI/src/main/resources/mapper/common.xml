<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper SYSTEM "dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.inzent.commonAPI.mapper.CommonMapper">
    <!--전체  API List 조회 -->
    <select id="apiInfo" resultType="map">
        SELECT * FROM API_INFO
    </select>

    <!--API_KEY 로 API_ID 반환  -->
    <select id="searchApiId" resultType="String">
        SELECT API_ID  FROM API_INFO
        WHERE API_KEY = #{api_key}
    </select>

    <!-- 특정 API_KEY가 존재하는지 확인 후 true/false 반환 -->
    <select id="apiExistence" resultType="String">
        SELECT
        CASE WHEN Count(*)>0 THEN 'true' ELSE 'false' END Result
        FROM DMS_CMN.API_INFO
        WHERE API_KEY IN (#{api_key})

    </select>
    
    <!--메뉴 조회 -->
    <select id="getMenu" resultType="com.inzent.commonAPI.vo.MenuVO">
        SELECT * FROM MENU
    </select>
    
    <!--메뉴별 권한 확인 -->
    <select id="authorityConfirm" resultType="String">
        SELECT
			COUNT(*)
		FROM
			MENU_AUTHORITY A,
			USERS U
		WHERE
			A.AUTHORITY_ID = U.AUTHORITY_ID
			AND A.MAPPING_URL = #{mappingUrl}
			AND A.METHOD_NAME = #{method}
			AND U.USER_ID = #{userId}
    </select>
    
</mapper>